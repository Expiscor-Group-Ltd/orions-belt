{# SPDX-License-Identifier: MIT
# Copyright (c) 2024 Marko Sarunac
#
# Part of the Orion's Belt project.
# Repository: https://github.com/Expiscor-Group-Ltd/orions-belt
# Template ID: OB-005-T

# Login Definitions Configuration
# Generated by Ansible Security Hardening Playbook

# Login definitions configuration template
# This template is used by OB-005 (password_policies.yml) #}

# Login Definitions Configuration
# Generated by Ansible Security Hardening Playbook

# Password aging controls
PASS_MAX_DAYS	{{ password_maxage }}
PASS_MIN_DAYS	{{ password_minage }}
PASS_WARN_AGE	{{ password_warnage }}

# User ID limits
UID_MIN			1000
UID_MAX			60000

# System user ID limits
SYS_UID_MIN		100
SYS_UID_MAX		999

# Group ID limits
GID_MIN			1000
GID_MAX			60000

# System group ID limits
SYS_GID_MIN		100
SYS_GID_MAX		999

# Default user settings
CREATE_HOME		yes
USERGROUPS_ENAB		yes

# Login settings
LOGIN_RETRIES		3
LOGIN_TIMEOUT		60
LOGIN_STRING		"Debian GNU/Linux"

# Console settings
CONSOLE			/etc/securetty
CONSOLE_GROUPS		floppy:audio:cdrom:dip:video:plugdev:scanner:bluetooth:netdev

# Default umask
UMASK			022

# Password encryption method
ENCRYPT_METHOD		SHA512

# User environment
ENV_PATH		/usr/local/bin:/usr/bin:/bin
ENV_ROOTPATH		/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

# Mail settings
MAIL_DIR		/var/mail
MAIL_FILE		.mail

# Hush login
HUSHLOGIN_FILE		.hushlogin

# Last log
LASTLOG_ENAB		yes
FAILLOG_ENAB		yes

# Logging
LOG_OK_LOGINS		no
LOG_UNKFAIL_ENAB	no
LOGIN_STRING		"Debian GNU/Linux"

# Chfn settings
CHFN_AUTH		yes
CHFN_RESTRICT		rwh

# Chsh settings
CHSH_AUTH		yes

# Default user shell
DEFAULT_HOME		yes

# User deletion
USERDEL_CMD		/usr/sbin/userdel -r

# Password aging
PASS_CHANGE_TRIES	3
PASS_ALWAYS_WARN	yes
PASS_MIN_LEN		{{ password_minlen }} 